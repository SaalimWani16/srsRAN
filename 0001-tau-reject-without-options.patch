From 6c8f8cb516768d65be732ec9c06ee9ed66f8b9b1 Mon Sep 17 00:00:00 2001
From: Saalim <saalimwani@gmail.com>
Date: Mon, 16 May 2022 19:25:14 +0200
Subject: [PATCH 1/2] tau reject without options

---
 0001-tau_reject_saalim.patch | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 0001-tau_reject_saalim.patch

diff --git a/0001-tau_reject_saalim.patch b/0001-tau_reject_saalim.patch
new file mode 100644
index 000000000..ccecf31eb
--- /dev/null
+++ b/0001-tau_reject_saalim.patch
@@ -0,0 +1,25 @@
+From f6ab7534297d067196009c3f56369f1c166d375b Mon Sep 17 00:00:00 2001
+From: Saalim <saalimwani@gmail.com>
+Date: Mon, 16 May 2022 17:10:57 +0200
+Subject: [PATCH]  tau_reject_saalim
+
+---
+ srsepc/src/mme/nas.cc | 2 +-
+ 1 file changed, 1 insertion(+), 1 deletion(-)
+
+diff --git a/srsepc/src/mme/nas.cc b/srsepc/src/mme/nas.cc
+index 6c8206398..7f47ddc33 100644
+--- a/srsepc/src/mme/nas.cc
++++ b/srsepc/src/mme/nas.cc
+@@ -1266,7 +1266,7 @@ bool nas::handle_tracking_area_update_request(srsran::byte_buffer_t* nas_rx)
+     return false;
+   }
+   // TODO we could enable integrity protection in some cases, but UE should comply anyway
+-  pack_tracking_area_update_reject(nas_tx.get(), LIBLTE_MME_EMM_CAUSE_IMPLICITLY_DETACHED);
++  pack_tracking_area_update_reject(nas_tx.get(), LIBLTE_MME_EMM_CAUSE_EPS_SERVICES_NOT_ALLOWED ;
+   // Send reply
+   m_s1ap->send_downlink_nas_transport(
+       m_ecm_ctx.enb_ue_s1ap_id, m_ecm_ctx.mme_ue_s1ap_id, nas_tx.get(), m_ecm_ctx.enb_sri);
+-- 
+2.25.1
+
-- 
2.25.1

